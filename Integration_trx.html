<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<link rel="stylesheet" href="assets/css/vendors.css" />
	<link rel="stylesheet" href="assets/css/helppage.css">

	<title>Saferpay documentation | docs</title>
</head>
<body data-spy="scroll" data-target="#navScrollspy">

	<div id="content" class="container-fluid">
		<div class="row">

			<nav class="col-lg-2 hidden-xs hidden-sm hidden-md" id="navScrollspy">
				<div data-spy="affix">
					<h3>
						<span style="font-size: x-large; font-weight: bold">Saferpay</span>
						<span class="text-primary">docs</span>
					</h3>

					<ul class="nav">
								<li>
										<a href="index.html">Introduction</a>
											<ul class="nav">
													<li><a href="#intro-requirement">Requirements</a></li>
													<li><a href="#pci">Data Security and PCI DSS</a></li>
													<li><a href="#3ds">3-D Secure</a></li>
													<li><a href="#dcc">Dynamic Currency Conversion</a></li>
													<li><a href="#paymentmethods">Supported Payment Methods</a></li>
													<li><a href="#licenses">Licences</a></li>
													<li><a href="#pm-functions">Payment Method Features</a></li>
													<li><a href="#capture-batch">Capture and Daily Closing</a></li>
													<li><a href="#capture">Capture</a></li>
													<li><a href="#closing">Daily Closing</a></li>
													<li><a href="#special">Special Cases</a></li>
													<li><a href="#cancel-refund">Cancel or Refund</a></li>
											</ul>
								</li>
								<li>
										<a href="Integration_PP.html">Payment Page</a>
											<ul class="nav">
													<li><a href="#pp-initialize">PaymentPage Initialize</a></li>
													<li><a href="#pp-initialize-response">PaymentPage Initialize Response</a></li>
													<li><a href="#pp-transaction">Redirect and Transaction</a></li>
													<li><a href="#pp-retshop">Return to the Shop</a></li>
													<li><a href="#pp-assert">PaymentPage Assert</a></li>
													<li><a href="#pp-captcancel">Capture or Cancel</a></li>
											</ul>
								</li>
								<li class="active">
										<a href="Integration_trx.html">Transaction Interface</a>
											<ul class="nav">
													<li><a href="#trx-cc">Credit Cards</a></li>
													<li><a href="#trx-ini">Transaction Initialize</a></li>
													<li><a href="#trx-3ds">3-D Secure and DCC</a></li>
													<li><a href="#trx-retshop">Return to the Shop</a></li>
													<li><a href="#trx-ta">Transaction Authorize</a></li>
													<li><a href="#trx-captcancel">Capture or Cancel</a></li>
													<li><a href="#trx-sepa">SEPA Direct Debit</a></li>
											</ul>
								</li>
								<li>
										<a href="recurring.html">Recurring Payments</a>
											<ul class="nav">
													<li><a href="#recurring-req">Requirements</a></li>
													<li><a href="#recurring-payment-methods">Supported Payment Methods</a></li>
													<li><a href="#recurring-referenced">Referenced  Transactions Method</a></li>
													<li><a href="#trx-ta">Automating the Recurring Payments</a></li>
											</ul>
								</li>
								<li>
										<a href="CssiFrame.html">IFrame Integration and CSS</a>
											<ul class="nav">
													<li><a href="#css-iframe">Iframe Integration</a></li>
													<li><a href="#css-pp">Payment Page</a></li>
													<li><a href="#css-trxini">Transaction Initialize</a></li>
													<li><a href="#css-aliasins">Alias Insert</a></li>
													<li><a href="#css-iframe_size">Size of the Iframe</a></li>
													<li><a href="#css-usecss">Using CSS</a></li>
													<li><a href="#css-element">CSS Elements</a></li>
													<li><a href="#css-selector">CSS Selectors</a></li>
													<li><a href="#css-info">Additional Info</a></li>
											</ul>
								</li>
								<li>
										<a href="PayPal.html">PayPal</a>
											<ul class="nav">
													<li><a href="#ppal-requirement">Requirements</a></li>
													<li><a href="#api-access">Grant API Approval for Saferpay</a></li>
													<li><a href="#merchant-protection">Seller Protection</a></li>
													<li><a href="#partial-capture">Partial Capture</a></li>
													<li><a href="#capture">Capture and the solvency of the customer</a></li>
											</ul>
								</li>
								<li>
										<a href="BillPay.html">BillPay</a>
											<ul class="nav">
													<li><a href="#bp-requirement">Requirements</a></li>
													<li><a href="#bp-approval-api">BillPay Certification via API</a></li>
													<li><a href="#bp-assert">Assert</a></li>
													<li><a href="#bp-capt">Capture</a></li>
													<li><a href="#bp-approval-bo">BillPay Certification via Saferpay Backoffice</a></li>
											</ul>
								</li>
								<li>
										<a href="PostFinance.html">Swiss Postcard</a>
											<ul class="nav">
													<li><a href="#pf-requirement">Requirements</a></li>
													<li><a href="#pf-alias">Storage in the Secure Card Data Store</a></li>
													<li><a href="#pf-regdial">Registration Dialogue</a></li>
											</ul>
								</li>
								<li>
										<a href="sofort.html">SOFORT</a>
											<ul class="nav">
													<li><a href="#sf-requirement">Requirements</a></li>
													<li><a href="#sf-newproject">Create a new project for SOFORT</a></li>
											</ul>
								</li>
								<li>
										<a href="eps.html">eps</a>
											<ul class="nav">
													<li><a href="#eps-requirement">Requirements</a></li>
													<li><a href="#eps-newproject">How toget an EPS acceptance agreement</a></li>
											</ul>
								</li>
								<li>
										<a href="paydirekt.html">paydirekt</a>
											<ul class="nav">
													<li><a href="#pd-requirement">Requirements</a></li>
													<li><a href="#pd-address">Handling of delivery address</a></li>
													<li><a href="#pd-pending">Display of pending status for bookings</a></li>
													<li><a href="#pd-note">Notification after change from pending to final status</a></li>
													<li><a href="#pd-query">Querying the transaction status</a></li>
													<li><a href="#pd-refund">Refunds</a></li>
											</ul>
								</li>
								<li>
										<a href="faq.html">FAQ</a>
								</li>
								<li>
										<a href="contact.html">Contact</a>
								</li>
								<li>
										<a href="http://saferpay.github.io/jsonapi/" target="_blank">API Specification</a>
								</li>

					</ul>
				</div>
			</nav>

			<span class="print-page-break"></span>

			<main class="col-lg-10 col-sm-12">

				<h3 class="hidden-lg">
					<span style="font-size: x-large; font-weight: bold">Saferpay</span>
					<span>docs</span>
				</h3>

				
<section><h1>Transaction Interface</h1><div class="row"><div class="col-lg-6"><p>The Transaction Interface is an extension to Payment Page. It can be operated in parallel or alone. The Transaction interface offers more functions for the processing and handling of payments, in comparison to the Payment Page.</p><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i><strong>NOTE:</strong> The JSON API can be used in various ways to cover the most diverse processes. For this reason, only the standard processes are discussed below. For other possible uses, or for questions about the standard procedures, please contact the <a href="https://saferpay.github.io/sndbx/contact.html"><strong>Saferpay Integration Team</strong></a>.</p>
</blockquote><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i><strong>Attention:</strong> The Transaction Interface is only for holders of a business licence on the live system. For the eCommerce licence, the advanced features are not available. The test accounts have business activated by default, for evaluation purposes.</p>
</blockquote></div></div></section><section id="trx-cc"><h2><a name="trx-cc"></a> Credit Cards</h2><div class="row"><div class="col-lg-6"><p>In contrast to the payment page, credit card payments can be seamlessly integrated into the merchant's shop with the Transaction Interface. The procedure will be described in the following.</p></div></div></section><section id="trx-ini"><h3><a name="trx-ini"></a>Transaction Initialize</h3><div class="row"><div class="col-lg-6"><p>The process begins with <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Initialize">Transaction Initialize</a>. With this request, you forward all data necessary for the payment to Saferpay. Such as your customer number (CustomerId), the terminal number (Terminal Id), the currency (CurrencyCode), the amount (Value), the internal reference number of the merchant system (OrderId), and the return addresses (ReturnUrls) to which the customer will return, depending on the outcome of the payment.</p></div></div></section><section><h3>Here are a few hints and tips about the options that are available for the merchant:</h3><div class="row"><div class="col-lg-6"><ul>
<li><p><strong>ReturnUrls:</strong> For security, Saferpay returns no data to return addresses of the shop. The identification of the payment or the returning customers is up to the merchant. We recommend using your own parameters. These can be attached via HTTP GET to the ReturnUrls. When a ReturnUrl is called, Saferpay returns the appended parameter, thus enabling identification of the customer.</p>
</li>
<li><p><strong>Secure Card Data:</strong> With the Initialize Request, it is also possible within Saferpay Secure Card Data to forward saved cards in the form of an alias. For example, this can be the case if the customers card number has been already saved (tokenized), and you do not want her or him to re-enter this data. To use the alias value instead of the actual card data, use the container PaymentMeans.</p>
</li>
</ul><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i> <strong>NOTE:</strong> Although it is not permitted to store the Card Verification Code (CVC), it is usually still required for the authorization (see <a href="#transaction-authorize">Transaction Authorize</a>)&nbsp; and must be requested with an own form.</p>
</blockquote></div></div></section><section><h3>In the Response of the Initialize Request these parameters are import for further processing:</h3><div class="row"><div class="col-lg-6"><ul>
<li><p><strong>Token:</strong> The Token is mandatory for further steps within the payment process and must therefore be cached. Preferably, it should be linked to the parameters attached to the ReturnUrls. It can thus be easily reassigned.</p>
</li>
<li><p><strong>RedirectUrl:</strong> Unlike with the Payment Page, this URL is not used for a redirect. Instead, it is embedded in an HTML Iframe. Within this, a form hosted by Saferpay is displayed. This form is also called the Hosted Entry Form. It can be used to capture sensitive card details in a PCI-compliant manner. You can find out more about the Iframe integration <a href="https://saferpay.github.io/sndbx/CssiFrame.html">in this chapter</a>.</p>
</li>
</ul><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i> <strong>NOTE:</strong> If an alias is forwarded in the initalize request, the display of the form will be skipped.</p>
</blockquote></div></div></section><section id="trx-3ds"><h3><a name="trx-3ds"></a> 3-D Secure and DCC</h3><div class="row"><div class="col-lg-6"><p>If <a href="https://saferpay.github.io/sndbx/index.html#3ds">3-D Secure</a> and/or <a href="https://saferpay.github.io/sndbx/index.html#dcc">DCC</a> are activated on the terminal for the payment method being used, these services are automatically conducted for the transaction as soon as the form has been sent. For this, no additional steps are necessary for the merchant.</p></div></div></section><section id="trx-retshop"><h3><a name="trx-retshop"></a>Return to the Shop</h3><div class="row"><div class="col-lg-6"><p>Once <a href="https://saferpay.github.io/sndbx/index.html#3ds">3-D Secure</a> and/or <a href="https://saferpay.github.io/sndbx/index.html#dcc">DCC</a> are completed, the card holder &#8211; depending on the outcome &#8211; is taken to one of the <strong>ReturnUrls</strong> in the shop. Here, the GET parameters can be read and the <strong>Token</strong> can be assigned to the transaction. With the <strong>Token</strong>, the payment can be continued to the next step.</p></div></div></section><section id="trx-ta"><h3><a name="trx-ta"></a>Transaction Authorize</h3><div class="row"><div class="col-lg-6"><p>With Payment Page, the payment is triggered automatically upon completion of <a href="https://saferpay.github.io/sndbx/index.html#3ds">3-D Secure</a> and/or <a href="https://saferpay.github.io/sndbx/index.html#dcc">DCC</a>. In contrast, with Transaction Interface it is triggered separately via <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Authorize">Authorize Request</a>.</p><p><strong>The Transaction Authorize Request offers further possibilities:</strong></p><ul>
<li><p><strong>Condition:</strong> With the <strong>Condition</strong> parameter, it can be specified that a payment will only be authorized when a 3-D Secure liability shift is present for it.</p>
</li>
<li><p><strong>Secure Card Data:</strong> Via the <strong>RegisterAlias</strong> container, card details from a payment can be stored safely and in conformity with PCI. For this, the alias for the card details is transmitted back to the merchant system with the authorization response. It is then available for another purchase in the shop, without customers having to enter their card details again. See for example the <a href="https://saferpay.github.io/sndbx/Integration_trx.html#trx-ini">Initialize request above</a>. The parameter&nbsp;<strong>IdGenerator</strong>&nbsp;is used to determine how the alias is generated. If&nbsp;<strong>MANUAL</strong> is specified, the shop system passes an absolutely unique value. With&nbsp;<strong>RANDOM</strong>, a random alphanumeric value is generated by Saferpay. With&nbsp;<strong>RANDOM_UNIQUE</strong>, it will be additionally verified prior to generation of the alias, as to whether or not the card number/expiration date combination already exists as an alias entry in the database. If so, the already existing alias is returned and nothing new is generated.</p>
</li>
</ul><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i> <strong>NOTE:</strong> A card will be registered only after a successful authorization.</p>
</blockquote><p><strong>Transaction Authorize Response data</strong></p><p>In case of success the authorization data is returned with the Transaction Authorize Response. Based on this data, it can be decided how the transaction is to proceed. The following data is interesting in this regard:</p><ul>
<li><p><strong>Transaction &gt; ID:</strong> The transaction identifier (<strong>Id</strong>) returned in the container <strong>Transaction</strong>, is a unique identifier for a transaction. The value is obligatory for further processing steps (Transaction <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Capture">Capture</a> or <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Cancel">Capture</a>) and should therefore be saved.</p>
</li>
<li><p><strong>ThreeDs:</strong> This container provides information about whether or not transaction liability shift via <a href="https://saferpay.github.io/sndbx/index.html#3ds">3-D Secure</a> is available or not. It is up to merchants whether or not they want to accept transactions without liability shift. Evaluation of the parameter provides the opportunity for merchants to incorporate appropriate rules here.</p>
</li>
</ul><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i> <strong>IMPORTANT:</strong> Accepting transaction without LiabilityShift happens at the merchants own risk.</p>
</blockquote><ul>
<li><strong>Transaction &gt; Status:</strong> As already described <a href="https://saferpay.github.io/sndbx/General.html#capture-batch">here</a>, this status states whether or not a transaction has to be finalized via <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Capture">Capture</a>. If the status is not <strong>CAPTURED</strong>, the capture must be run in order to finalize the transaction.</li>
</ul><blockquote>
<p><i class="glyphicon glyphicon-hand-right"></i> <strong>Tipp:</strong> You can also call Authorize, if the FailUrl has been called. It will then give you information about the error!</p>
</blockquote></div></div></section><section id="trx-captcancel"><h3><a name="trx-captcancel"></a>Capture or Cancel</h3><div class="row"><div class="col-lg-6"><p>Subsequently, the transaction will be finalised via <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Capture">Capture</a> or broken off via <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Cancel">Cancel</a>. For this, the transaction identifier <strong>Id</strong> is required. Please refer to the notes on the payment methods on if and when a capture is necessary, and whether or not a Cancel can still be carried out.
Once these steps have been finalised, the transaction is complete.</p></div></div></section><section id="trx-sepa"><h2><a name="trx-sepa"></a> SEPA Direct Debit</h2><div class="row"><div class="col-lg-6"><p>Because there are no PCI requirements for direct debits, bank details data can be captured directly. The use of an in-house HTML form and the subsequent payment request are allowed. For this, the bank details must be forwarded to <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_AuthorizeDirect">AuthorizeDirect</a> with the <strong>BankAccount</strong> parameter in the <strong>PaymentMeans</strong> container.</p></div></div></section>

			</main>

		</div>
	</div>

	<div class="scroll-top-wrapper">
		<a href="#top" class="scroll-top-inner" onclick="$('html,body').animate({ scrollTop: 0 }, 'slow'); return false;">
			<span class="glyphicon glyphicon-chevron-up"></span> Back to Top
		</a>
	</div>

	<script src="assets/js/vendors.js"></script>
	<script src="assets/js/helppage.js"></script>
</body>
</html>

